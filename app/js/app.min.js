document.addEventListener("DOMContentLoaded", () => {
    const widthScreen = window.innerWidth || document.documentElement.clientWidth ||
        document.body.clientWidth;

    /*
        function getScrollMenu() {
            let el = document.body;
            if (pageYOffset > 300) {
                el.classList.add('fix_menu');
            } else {
                el.classList.remove("fix_menu");
            }
        }

        getScrollMenu();
        window.addEventListener('scroll', function () {
            getScrollMenu();
        });*/

    if (document.getElementById('nominations')) {
        const sliderBrands = new Swiper('#nominations', {
            spaceBetween: 20,
            slidesPerView: 3,
            slidesPerGroup: 1,
            pagination: {
                el: '#nominationsPage',
                clickable: true,
            },

            breakpoints: {
                300: {
                    slidesPerView: 1,
                    spaceBetween: 16
                },
                440: {
                    slidesPerView: 1,
                    spaceBetween: 16
                },
                768: {
                    slidesPerView: 'auto',
                    spaceBetween: 20
                },
                1199: {
                    slidesPerView: 'auto',
                    spaceBetween: 20
                },
                1300: {
                    slidesPerView: 3,
                    spaceBetween: 20
                },
            },

        });
    }

    if (document.getElementById('newsSlider')) {
        const sliderBrands = new Swiper('#newsSlider', {
            spaceBetween: 6,
            slidesPerView: 3,
            slidesPerGroup: 1,
            loop: true,
            breakpoints: {
                300: {
                    slidesPerView: 1,
                },
                440: {
                    slidesPerView: 1,

                },
                768: {
                    slidesPerView: 2,

                },
                991: {
                    slidesPerView: 3,

                },
                1200: {
                    slidesPerView: 3,

                },
            },

        });
    }

    const jsPass = document.querySelectorAll('.js-pass');

    jsPass.forEach(el => {
        el.addEventListener('click', (event) => {
            if (document.getElementById(el.dataset.target)) {
                let inputPass = document.getElementById(el.dataset.target);
                if (inputPass.type === 'password') {
                    inputPass.type = 'text';
                    el.classList.add('active');
                } else {
                    inputPass.type = 'password';
                    el.classList.remove('active');
                }
            }
        });
    });

    const maskPhone = document.querySelectorAll('.js-mask-phone');
    maskPhone.forEach(el => {
        let im = new Inputmask("+7 999 999-99-99", {"clearIncomplete": true});
        im.mask(el);
    });

    if (document.getElementById('photo')) {
        let photoInp = document.getElementById('photo');
        let photoName = document.getElementById('photoName');
        let photoBtn = document.getElementById('photoBtn');
        let photoImg = document.getElementById('photoImg');
        let photoLabel = document.getElementById('photoLabel');

        photoInp.addEventListener('change', (e) => {
            if (photoInp.files.length) {
                let new_file_input = '<div class="input-file-list-item">' +
                    '<span class="input-file-list-name">' + photoInp.files[0].name + '</span>' +
                    '<a href="#" onclick="removeFilesItem(); return false;" class="input-file-list-remove"></a>' +
                    '</div>';
                photoLabel.classList.add('d-none');
                photoName.innerHTML = new_file_input;

            }
        });
    }

    if (document.getElementById('slider')) {
        var swiper = new Swiper("#slider2", {
            spaceBetween: 20,
            slidesPerView: 4,
            freeMode: true,
            watchSlidesProgress: true,
            navigation: {
                nextEl: "#sliderNext",
                prevEl: "#sliderPrev",
            },
        });
        var swiper2 = new Swiper("#slider", {
            spaceBetween: 10,

            thumbs: {
                swiper: swiper,
            },
            breakpoints: {
                300: {
                    pagination: {
                        el: '#nominationsPage',
                        clickable: true,
                    },
                },
                440: {
                    pagination: {
                        el: '#single-newsPage',
                        clickable: true,
                    },

                },
                768: {
                    pagination: false,

                },
                991: {
                    pagination: false,

                },
                1200: {
                    pagination: false,

                },
            },
        });
    }

    if (widthScreen < 991) {
        const navbarHeader = document.getElementById('navbarHeader');
        const lkNavMob = document.getElementById('lkNavMob');
        const navbarHeaderBtn = document.getElementById('navbarHeaderBtn');

        navbarHeader.addEventListener('show.bs.collapse', event => {
            if (lkNavMob.classList.contains('show')) {
                lkNavMob.classList.remove('show');
            }
        });
        if (lkNavMob) {
            lkNavMob.addEventListener('show.bs.collapse', event => {
                if (navbarHeader.classList.contains('show')) {
                    navbarHeader.classList.remove('show');
                    navbarHeaderBtn.classList.add('collapsed');
                }
            });
        }
    }

    const maskBirth = document.getElementById('birthdate');
    if (maskBirth) {
        let maskBirthim = new Inputmask("datetime", {
            alias: "datetime",
            placeholder: "дд.мм.гггг",
            inputFormat: "dd.mm.yyyy",
            "clearIncomplete": true
        });
        maskBirthim.mask(maskBirth);
    }

    const maskPassport = document.getElementById('passport');
    if (maskPassport) {
        let inpPassport = new Inputmask("9999 999999", {
            placeholder: "____ ______",
            "clearIncomplete": true
        });
        inpPassport.mask(maskPassport);
    }


    const scans = document.querySelectorAll('.js-scan-file');
    scans.forEach(el => {
        let scanInp = el.querySelector('.input-file__file__val');
        let photoName = document.getElementById(el.dataset.name);
        let photoLabel = document.getElementById(el.dataset.label);
        let scan = scanInp.dataset.scan;

        scanInp.addEventListener('change', (e) => {
            if (scanInp.files.length) {
                let new_file_input = '<div class="input-file-list-item">' +
                    '<span class="input-file-list-name">' + scanInp.files[0].name + '</span>' +
                    '<a href="#" onclick="removeScan(' + scan + '); return false;" class="input-file-list-remove"></a>' +
                    '</div>';
                photoLabel.classList.add('d-none');
                photoName.innerHTML = new_file_input;
                let event = new Event("change");
                scanInp.dispatchEvent(event);
            }
        });
    });

});

function removeScan(idScan) {
    let scan = document.getElementById(idScan.id);
    let photoInp = scan.querySelector('.input-file__file__val');
    let photoName = document.getElementById(scan.dataset.name);
    let photoLabel = document.getElementById(scan.dataset.label);

    photoLabel.classList.remove('d-none');
    photoName.innerHTML = '';

    photoInp.value = '';

    //console.log(idScan.id);
}

function removeFilesItem() {
    let photoInp = document.getElementById('photo');
    let photoName = document.getElementById('photoName');
    let photoBtn = document.getElementById('photoBtn');
    let photoImg = document.getElementById('photoImg');
    let photoLabel = document.getElementById('photoLabel');

    photoLabel.classList.remove('d-none');
    photoName.innerHTML = '';
    if (photoImg) {
        photoImg.innerHTML = '';
    }
    photoInp.value = '';
}
